name: ğŸ™ æ›´æ–° gh-pages ç«™ç‚¹

on:
  workflow_dispatch: # æ‰‹åŠ¨è§¦å‘
  push:
    branches: [ master ]
    paths: ['CHECKLIST.md']

jobs:
  update-readme:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€å‡ºä»£ç åº“
        uses: actions/checkout@v2
        with:
          fetch-depth: 0

      - name: é…ç½® git
        run: |
          git config --global user.email "liss-bot@d0h.co"
          git config --global user.name "Liss.Bot"

      - name: å¤åˆ¶ CHECKLIST.md åˆ° gh-pages
        run: |
          # è·å–æ‰€æœ‰åˆ†æ”¯
          git fetch --all
          
          # åˆ‡æ¢åˆ° gh-pages åˆ†æ”¯
          git checkout gh-pages
          
          # ä» master åˆ†æ”¯å¤åˆ¶ CHECKLIST.md
          git checkout master -- CHECKLIST.md
          
          # ç§»åŠ¨å¹¶é‡å‘½å CHECKLIST.md åˆ°æ ¹ç›®å½•
          mv CHECKLIST.md README.md
          
          # æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ”¹ï¼Œå¦‚æœ‰åˆ™æäº¤å¹¶æ¨é€
          if [ -n "$(git status --porcelain)" ]; then
            git add README.md
            git commit -m "ä» master åˆ†æ”¯æ›´æ–° README.md"
            git push origin gh-pages
          else
            echo "README.md æ²¡æœ‰å˜åŒ–"
          fi

